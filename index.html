<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commerce Calculator Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-light: #f8fafc;
            --bg-dark: #1e293b;
            --card-light: #ffffff;
            --card-dark: #334155;
            --text-light: #1e293b;
            --text-dark: #f1f5f9;
            --border-light: #e2e8f0;
            --border-dark: #475569;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-light);
            transition: all 0.3s ease;
            min-height: 100vh;
        }

        body.dark-theme {
            background: var(--bg-dark);
            color: var(--text-dark);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theme-toggle {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .home-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: var(--card-light);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .dark-theme .feature-card {
            background: var(--card-dark);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .feature-card h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .card {
            background: var(--card-light);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .dark-theme .card {
            background: var(--card-dark);
        }

        .back-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: var(--primary-dark);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            font-size: 16px;
            background: var(--card-light);
            color: var(--text-light);
            transition: all 0.3s;
        }

        .dark-theme input,
        .dark-theme select,
        .dark-theme textarea {
            background: var(--bg-dark);
            color: var(--text-dark);
            border-color: var(--border-dark);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .result-box {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 18px;
        }

        .result-item {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        .dark-theme th,
        .dark-theme td {
            border-color: var(--border-dark);
        }

        th {
            background: var(--primary);
            color: white;
        }

        .total-row {
            font-weight: bold;
            background: var(--bg-light);
        }

        .dark-theme .total-row {
            background: var(--bg-dark);
        }

        .match-indicator {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            margin-top: 15px;
        }

        .match-indicator.success {
            background: var(--success);
            color: white;
        }

        .match-indicator.error {
            background: var(--danger);
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: normal;
        }

        .help-text {
            font-size: 14px;
            color: #64748b;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 22px;
            }
            
            .home-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Commerce Calculator Pro</h1>
            <button class="theme-toggle" onclick="toggleTheme()">üåì Toggle Theme</button>
        </header>

        <!-- Home Screen -->
        <div id="home" class="screen active">
            <div class="home-grid">
                <div class="feature-card" onclick="showScreen('gst')">
                    <div class="feature-icon">üí∞</div>
                    <h3>GST Calculator</h3>
                    <p>Calculate GST for Indian tax rates</p>
                </div>
                <div class="feature-card" onclick="showScreen('debitCredit')">
                    <div class="feature-icon">üìä</div>
                    <h3>Debit/Credit Helper</h3>
                    <p>Determine debit or credit entries</p>
                </div>
                <div class="feature-card" onclick="showScreen('trialBalance')">
                    <div class="feature-icon">‚öñÔ∏è</div>
                    <h3>Trial Balance Maker</h3>
                    <p>Create and verify trial balance</p>
                </div>
                <div class="feature-card" onclick="showScreen('depreciation')">
                    <div class="feature-icon">üìâ</div>
                    <h3>Depreciation Calculator</h3>
                    <p>Calculate asset depreciation</p>
                </div>
                <div class="feature-card" onclick="showScreen('statistics')">
                    <div class="feature-icon">üìà</div>
                    <h3>Statistics Calculator</h3>
                    <p>Calculate mean, median, mode & more</p>
                </div>
                <div class="feature-card" onclick="showScreen('settings')">
                    <div class="feature-icon">‚öôÔ∏è</div>
                    <h3>Settings & Help</h3>
                    <p>Formulas and app information</p>
                </div>
            </div>
        </div>

        <!-- GST Calculator -->
        <div id="gst" class="screen">
            <button class="back-btn" onclick="showScreen('home')">‚Üê Back to Home</button>
            <div class="card">
                <h2>üí∞ GST Calculator</h2>
                <div class="input-group">
                    <label>Amount (‚Çπ)</label>
                    <input type="number" id="gstAmount" placeholder="Enter amount">
                </div>
                <div class="input-group">
                    <label>GST Rate</label>
                    <select id="gstRate">
                        <option value="5">5%</option>
                        <option value="12">12%</option>
                        <option value="18" selected>18%</option>
                        <option value="28">28%</option>
                        <option value="custom">Custom Rate</option>
                    </select>
                </div>
                <div class="input-group" id="customGstGroup" style="display:none;">
                    <label>Custom GST Rate (%)</label>
                    <input type="number" id="customGst" placeholder="Enter custom rate">
                </div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="calculateGST('add')">Add GST</button>
                    <button class="btn btn-danger" onclick="calculateGST('remove')">Remove GST</button>
                </div>
                <div id="gstResult"></div>
            </div>
        </div>

        <!-- Debit/Credit Helper -->
        <div id="debitCredit" class="screen">
            <button class="back-btn" onclick="showScreen('home')">‚Üê Back to Home</button>
            <div class="card">
                <h2>üìä Debit/Credit Helper</h2>
                <div class="input-group">
                    <label>Account Name</label>
                    <input type="text" id="accountName" placeholder="e.g., Cash, Bank, Salary">
                </div>
                <div class="input-group">
                    <label>Account Type</label>
                    <select id="accountType">
                        <option value="">Select Account Type</option>
                        <option value="asset">Asset</option>
                        <option value="liability">Liability</option>
                        <option value="expense">Expense</option>
                        <option value="income">Income</option>
                        <option value="capital">Capital</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Transaction Type</label>
                    <select id="transactionType">
                        <option value="">Select Transaction</option>
                        <option value="increase">Increase</option>
                        <option value="decrease">Decrease</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Amount (‚Çπ)</label>
                    <input type="number" id="dcAmount" placeholder="Enter amount">
                </div>
                <div class="btn-group">
                    <button class="btn" onclick="determineDebitCredit()">Determine Entry</button>
                    <button class="btn btn-success" onclick="saveToTrialBalance()">Save to Trial Balance</button>
                </div>
                <div id="dcResult"></div>
            </div>
        </div>

        <!-- Trial Balance -->
        <div id="trialBalance" class="screen">
            <button class="back-btn" onclick="showScreen('home')">‚Üê Back to Home</button>
            <div class="card">
                <h2>‚öñÔ∏è Trial Balance Maker</h2>
                <div class="input-group">
                    <label>Account Name</label>
                    <input type="text" id="tbAccount" placeholder="Enter account name">
                </div>
                <div class="input-group">
                    <label>Debit Amount (‚Çπ)</label>
                    <input type="number" id="tbDebit" placeholder="Enter debit amount (0 if credit)">
                </div>
                <div class="input-group">
                    <label>Credit Amount (‚Çπ)</label>
                    <input type="number" id="tbCredit" placeholder="Enter credit amount (0 if debit)">
                </div>
                <div class="btn-group">
                    <button class="btn" onclick="addToTrialBalance()">Add Entry</button>
                    <button class="btn btn-danger" onclick="clearTrialBalance()">Clear All</button>
                    <button class="btn btn-secondary" onclick="exportTrialBalance()">Export as Text</button>
                </div>
                <table id="trialBalanceTable">
                    <thead>
                        <tr>
                            <th>Account Name</th>
                            <th>Debit (‚Çπ)</th>
                            <th>Credit (‚Çπ)</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tbBody"></tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td><strong>Total</strong></td>
                            <td><strong id="totalDebit">0.00</strong></td>
                            <td><strong id="totalCredit">0.00</strong></td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
                <div id="tbMatch"></div>
            </div>
        </div>

        <!-- Depreciation Calculator -->
        <div id="depreciation" class="screen">
            <button class="back-btn" onclick="showScreen('home')">‚Üê Back to Home</button>
            <div class="card">
                <h2>üìâ Depreciation Calculator</h2>
                <div class="input-group">
                    <label>Asset Cost (‚Çπ)</label>
                    <input type="number" id="assetCost" placeholder="Enter asset cost">
                </div>
                <div class="input-group">
                    <label>Salvage Value (‚Çπ)</label>
                    <input type="number" id="salvageValue" placeholder="Enter salvage value">
                </div>
                <div class="input-group">
                    <label>Useful Life (Years)</label>
                    <input type="number" id="usefulLife" placeholder="Enter useful life">
                </div>
                <div class="input-group">
                    <label>Depreciation Method</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="depMethod" value="slm" checked> Straight Line Method (SLM)
                        </label>
                        <label>
                            <input type="radio" name="depMethod" value="wdv"> Written Down Value (WDV)
                        </label>
                    </div>
                </div>
                <button class="btn" onclick="calculateDepreciation()">Calculate Depreciation</button>
                <div id="depResult"></div>
            </div>
        </div>

        <!-- Statistics Calculator -->
        <div id="statistics" class="screen">
            <button class="back-btn" onclick="showScreen('home')">‚Üê Back to Home</button>
            <div class="card">
                <h2>üìà Statistics Calculator</h2>
                <div class="input-group">
                    <label>Enter Numbers (comma separated)</label>
                    <textarea id="statsNumbers" rows="4" placeholder="e.g., 10, 20, 30, 40, 50"></textarea>
                    <div class="help-text">Enter numbers separated by commas</div>
                </div>
                <button class="btn" onclick="calculateStatistics()">Calculate Statistics</button>
                <div id="statsResult"></div>
            </div>
        </div>

        <!-- Settings & Help -->
        <div id="settings" class="screen">
            <button class="back-btn" onclick="showScreen('home')">‚Üê Back to Home</button>
            <div class="card">
                <h2>‚öôÔ∏è Settings & Help</h2>
                <h3>üìù Formula Reference</h3>
                <div style="margin: 20px 0;">
                    <h4>GST Calculation</h4>
                    <p><strong>Add GST:</strong> Final Amount = Amount + (Amount √ó GST Rate / 100)</p>
                    <p><strong>Remove GST:</strong> Original Amount = Amount / (1 + GST Rate / 100)</p>
                    
                    <h4 style="margin-top: 20px;">Depreciation Methods</h4>
                    <p><strong>SLM:</strong> Annual Depreciation = (Cost - Salvage Value) / Useful Life</p>
                    <p><strong>WDV:</strong> Rate = 1 - (Salvage Value / Cost)^(1/Life)</p>
                    
                    <h4 style="margin-top: 20px;">Statistics Formulas</h4>
                    <p><strong>Mean:</strong> Sum of all values / Count</p>
                    <p><strong>Median:</strong> Middle value when sorted</p>
                    <p><strong>Mode:</strong> Most frequently occurring value</p>
                    <p><strong>Variance:</strong> Average of squared differences from mean</p>
                    <p><strong>Standard Deviation:</strong> ‚àöVariance</p>
                    
                    <h4 style="margin-top: 20px;">Debit/Credit Rules</h4>
                    <p><strong>Assets:</strong> Increase = Debit, Decrease = Credit</p>
                    <p><strong>Liabilities:</strong> Increase = Credit, Decrease = Debit</p>
                    <p><strong>Expenses:</strong> Increase = Debit, Decrease = Credit</p>
                    <p><strong>Income:</strong> Increase = Credit, Decrease = Debit</p>
                    <p><strong>Capital:</strong> Increase = Credit, Decrease = Debit</p>
                </div>
                
                <h3 style="margin-top: 30px;">‚ÑπÔ∏è About</h3>
                <p>Commerce Calculator Pro - Class 11</p>
                <p>Version 1.0</p>
                <p>Designed for Class 11 Commerce students to help with Accounts, Economics, and Statistics calculations.</p>
            </div>
        </div>
    </div>

    <script>
        let trialBalanceData = [];

        // Theme Toggle
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        }

        // Load saved theme
        window.onload = function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
        };

        // Screen Navigation
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // GST Rate Change
        document.getElementById('gstRate').addEventListener('change', function() {
            document.getElementById('customGstGroup').style.display = 
                this.value === 'custom' ? 'block' : 'none';
        });

        // GST Calculator
        function calculateGST(type) {
            const amount = parseFloat(document.getElementById('gstAmount').value);
            const rateSelect = document.getElementById('gstRate').value;
            let rate = rateSelect === 'custom' ? 
                parseFloat(document.getElementById('customGst').value) : 
                parseFloat(rateSelect);

            if (isNaN(amount) || isNaN(rate)) {
                alert('Please enter valid values');
                return;
            }

            let gstAmount, finalAmount, result;

            if (type === 'add') {
                gstAmount = (amount * rate) / 100;
                finalAmount = amount + gstAmount;
                result = `
                    <div class="result-box">
                        <h3>GST Added</h3>
                        <div class="result-item">Original Amount: ‚Çπ${amount.toFixed(2)}</div>
                        <div class="result-item">GST Rate: ${rate}%</div>
                        <div class="result-item">GST Amount: ‚Çπ${gstAmount.toFixed(2)}</div>
                        <div class="result-item"><strong>Final Amount: ‚Çπ${finalAmount.toFixed(2)}</strong></div>
                        <button class="btn" style="margin-top: 10px;" onclick="copyResult('Final Amount: ‚Çπ${finalAmount.toFixed(2)}')">üìã Copy Result</button>
                    </div>
                `;
            } else {
                const originalAmount = amount / (1 + rate / 100);
                gstAmount = amount - originalAmount;
                result = `
                    <div class="result-box">
                        <h3>GST Removed</h3>
                        <div class="result-item">Amount with GST: ‚Çπ${amount.toFixed(2)}</div>
                        <div class="result-item">GST Rate: ${rate}%</div>
                        <div class="result-item">GST Amount: ‚Çπ${gstAmount.toFixed(2)}</div>
                        <div class="result-item"><strong>Original Amount: ‚Çπ${originalAmount.toFixed(2)}</strong></div>
                        <button class="btn" style="margin-top: 10px;" onclick="copyResult('Original Amount: ‚Çπ${originalAmount.toFixed(2)}')">üìã Copy Result</button>
                    </div>
                `;
            }

            document.getElementById('gstResult').innerHTML = result;
        }

        // Copy to Clipboard
        function copyResult(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }

        // Debit/Credit Helper
        function determineDebitCredit() {
            const accountName = document.getElementById('accountName').value;
            const accountType = document.getElementById('accountType').value;
            const transactionType = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('dcAmount').value);

            if (!accountName || !accountType || !transactionType || isNaN(amount)) {
                alert('Please fill all fields');
                return;
            }

            let entry = '';
            
            if (accountType === 'asset') {
                entry = transactionType === 'increase' ? 'Debit' : 'Credit';
            } else if (accountType === 'liability' || accountType === 'capital') {
                entry = transactionType === 'increase' ? 'Credit' : 'Debit';
            } else if (accountType === 'expense') {
                entry = transactionType === 'increase' ? 'Debit' : 'Credit';
            } else if (accountType === 'income') {
                entry = transactionType === 'increase' ? 'Credit' : 'Debit';
            }

            const result = `
                <div class="result-box">
                    <h3>Journal Entry</h3>
                    <div class="result-item">Account: ${accountName}</div>
                    <div class="result-item">Type: ${accountType.charAt(0).toUpperCase() + accountType.slice(1)}</div>
                    <div class="result-item">Transaction: ${transactionType.charAt(0).toUpperCase() + transactionType.slice(1)}</div>
                    <div class="result-item">Amount: ‚Çπ${amount.toFixed(2)}</div>
                    <div class="result-item"><strong>Entry: ${entry}</strong></div>
                </div>
            `;

            document.getElementById('dcResult').innerHTML = result;
        }

        // Save to Trial Balance
        function saveToTrialBalance() {
            const accountName = document.getElementById('accountName').value;
            const accountType = document.getElementById('accountType').value;
            const transactionType = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('dcAmount').value);

            if (!accountName || !accountType || !transactionType || isNaN(amount)) {
                alert('Please determine the entry first');
                return;
            }

            let debit = 0, credit = 0;
            
            if (accountType === 'asset') {
                if (transactionType === 'increase') debit = amount;
                else credit = amount;
            } else if (accountType === 'liability' || accountType === 'capital') {
                if (transactionType === 'increase') credit = amount;
                else debit = amount;
            } else if (accountType === 'expense') {
                if (transactionType === 'increase') debit = amount;
                else credit = amount;
            } else if (accountType === 'income') {
                if (transactionType === 'increase') credit = amount;
                else debit = amount;
            }

            trialBalanceData.push({
                account: accountName,
                debit: debit,
                credit: credit
            });

            alert('Added to Trial Balance!');
            showScreen('trialBalance');
            renderTrialBalance();
        }

        // Trial Balance Functions
        function addToTrialBalance() {
            const account = document.getElementById('tbAccount').value;
            const debit = parseFloat(document.getElementById('tbDebit').value) || 0;
            const credit = parseFloat(document.getElementById('tbCredit').value) || 0;

            if (!account) {
                alert('Please enter account name');
                return;
            }

            if (debit > 0 && credit > 0) {
                alert('An entry cannot have both debit and credit');
                return;
            }

            trialBalanceData.push({ account, debit, credit });
            renderTrialBalance();

            document.getElementById('tbAccount').value = '';
            document.getElementById('tbDebit').value = '';
            document.getElementById('tbCredit').value = '';
        }

        function renderTrialBalance() {
            const tbody = document.getElementById('tbBody');
            tbody.innerHTML = '';

            let totalDebit = 0;
            let totalCredit = 0;

            trialBalanceData.forEach((entry, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${entry.account}</td>
                    <td>${entry.debit.toFixed(2)}</td>
                    <td>${entry.credit.toFixed(2)}</td>
                    <td><button class="btn btn-danger" style="padding: 5px 10px; margin: 0;" onclick="deleteEntry(${index})">Delete</button></td>
                `;
                totalDebit += entry.debit;
                totalCredit += entry.credit;
            });

            document.getElementById('totalDebit').textContent = totalDebit.toFixed(2);
            document.getElementById('totalCredit').textContent = totalCredit.toFixed(2);

            const matchDiv = document.getElementById('tbMatch');
            if (totalDebit === totalCredit && totalDebit > 0) {
                matchDiv.innerHTML = '<div class="match-indicator success">‚úî Trial Balance Matches!</div>';
            } else if (totalDebit > 0 || totalCredit > 0) {
                const difference = Math.abs(totalDebit - totalCredit);
                matchDiv.innerHTML = `<div class="match-indicator error">‚úñ Trial Balance does not match! Difference: ‚Çπ${difference.toFixed(2)}</div>`;
            } else {
                matchDiv.innerHTML = '';
            }
        }

        function deleteEntry(index) {
            trialBalanceData.splice(index, 1);
            renderTrialBalance();
        }

        function clearTrialBalance() {
            if (confirm('Are you sure you want to clear all entries?')) {
                trialBalanceData = [];
                renderTrialBalance();
            }
        }

        function exportTrialBalance() {
            if (trialBalanceData.length === 0) {
                alert('No entries to export');
                return;
            }

            let text = 'TRIAL BALANCE\n';
            text += '='.repeat(60) + '\n';
            text += 'Account Name'.padEnd(30) + 'Debit'.padEnd(15) + 'Credit\n';
            text += '-'.repeat(60) + '\n';

            let totalDebit = 0;
            let totalCredit = 0;

            trialBalanceData.forEach(entry => {
                text += entry.account.padEnd(30) + 
                        entry.debit.toFixed(2).padEnd(15) + 
                        entry.credit.toFixed(2) + '\n';
                totalDebit += entry.debit;
                totalCredit += entry.credit;
            });

            text += '='.repeat(60) + '\n';
            text += 'Total'.padEnd(30) + 
                    totalDebit.toFixed(2).padEnd(15) + 
                    totalCredit.toFixed(2) + '\n';

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'trial_balance.txt';
            a.click();
        }

        // Depreciation Calculator
        function calculateDepreciation() {
            const cost = parseFloat(document.getElementById('assetCost').value);
            const salvage = parseFloat(document.getElementById('salvageValue').value);
            const life = parseInt(document.getElementById('usefulLife').value);
            const method = document.querySelector('input[name="depMethod"]:checked').value;

            if (isNaN(cost) || isNaN(salvage) || isNaN(life)) {
                alert('Please fill all fields');
                return;
            }

            if (salvage >= cost) {
                alert('Salvage value must be less than asset cost');
                return;
            }

            let result = '<div class="result-box"><h3>Depreciation Schedule</h3>';

            if (method === 'slm') {
                const annualDep = (cost - salvage) / life;
                result += `<div class="result-item"><strong>Annual Depreciation: ‚Çπ${annualDep.toFixed(2)}</strong></div>`;
                result += '<table style="margin-top: 15px; color: white;"><thead><tr><th>Year</th><th>Depreciation</th><th>Accumulated Dep.</th><th>Book Value</th></tr></thead><tbody>';

                let accumulated = 0;
                for (let year = 1; year <= life; year++) {
                    accumulated += annualDep;
                    const bookValue = cost - accumulated;
                    result += `<tr>
                        <td>${year}</td>
                        <td>‚Çπ${annualDep.toFixed(2)}</td>
                        <td>‚Çπ${accumulated.toFixed(2)}</td>
                        <td>‚Çπ${bookValue.toFixed(2)}</td>
                    </tr>`;
                }
                result += '</tbody></table>';
            } else {
                const rate = (1 - Math.pow(salvage / cost, 1 / life)) * 100;
                result += `<div class="result-item"><strong>Depreciation Rate: ${rate.toFixed(2)}%</strong></div>`;
                result += '<table style="margin-top: 15px; color: white;"><thead><tr><th>Year</th><th>Opening Value</th><th>Depreciation</th><th>Closing Value</th></tr></thead><tbody>';

                let bookValue = cost;
                for (let year = 1; year <= life; year++) {
                    const depreciation = bookValue * (rate / 100);
                    const closingValue = bookValue - depreciation;
                    result += `<tr>
                        <td>${year}</td>
                        <td>‚Çπ${bookValue.toFixed(2)}</td>
                        <td>‚Çπ${depreciation.toFixed(2)}</td>
                        <td>‚Çπ${closingValue.toFixed(2)}</td>
                    </tr>`;
                    bookValue = closingValue;
                }
                result += '</tbody></table>';
            }

            result += '</div>';
            document.getElementById('depResult').innerHTML = result;
        }

        // Statistics Calculator
        function calculateStatistics() {
            const input = document.getElementById('statsNumbers').value;
            const numbers = input.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));

            if (numbers.length === 0) {
                alert('Please enter valid numbers');
                return;
            }

            // Sort for median calculation
            const sorted = [...numbers].sort((a, b) => a - b);

            // Mean
            const sum = numbers.reduce((a, b) => a + b, 0);
            const mean = sum / numbers.length;

            // Median
            let median;
            const mid = Math.floor(sorted.length / 2);
            if (sorted.length % 2 === 0) {
                median = (sorted[mid - 1] + sorted[mid]) / 2;
            } else {
                median = sorted[mid];
            }

            // Mode
            const frequency = {};
            let maxFreq = 0;
            numbers.forEach(n => {
                frequency[n] = (frequency[n] || 0) + 1;
                if (frequency[n] > maxFreq) maxFreq = frequency[n];
            });
            const modes = Object.keys(frequency).filter(k => frequency[k] === maxFreq);
            const mode = maxFreq > 1 ? modes.join(', ') : 'No mode';

            // Range
            const range = sorted[sorted.length - 1] - sorted[0];

            // Variance and Standard Deviation
            const squaredDiffs = numbers.map(n => Math.pow(n - mean, 2));
            const variance = squaredDiffs.reduce((a, b) => a + b, 0) / numbers.length;
            const stdDev = Math.sqrt(variance);

            // Sum of x and x¬≤
            const sumX = sum;
            const sumXSquared = numbers.reduce((a, b) => a + b * b, 0);

            const result = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Count (n)</div>
                        <div class="stat-value">${numbers.length}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Mean (xÃÑ)</div>
                        <div class="stat-value">${mean.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Median</div>
                        <div class="stat-value">${median.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Mode</div>
                        <div class="stat-value">${mode}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Range</div>
                        <div class="stat-value">${range.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Variance (œÉ¬≤)</div>
                        <div class="stat-value">${variance.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Std. Deviation (œÉ)</div>
                        <div class="stat-value">${stdDev.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Œ£x</div>
                        <div class="stat-value">${sumX.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Œ£x¬≤</div>
                        <div class="stat-value">${sumXSquared.toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Minimum</div>
                        <div class="stat-value">${sorted[0].toFixed(2)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Maximum</div>
                        <div class="stat-value">${sorted[sorted.length - 1].toFixed(2)}</div>
                    </div>
                </div>
            `;

            document.getElementById('statsResult').innerHTML = result;
        }
    </script>
</body>
</html>
